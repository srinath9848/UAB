@model UAB.DTO.SearchParametersDTO

@{
    ViewData["Title"] = "Search";
}

<style>
    .lblSearch {
        width: 100px;
        margin-left: 15px;
    }

    .txtwidth {
        width: 210px;
    }
    .table td, .table th {
        padding: 10px !important;
        vertical-align: top;
        border-top: 1px solid #dee2e6;
    }
</style>

<div class="col-md-10">
    <h5 class="card-title" style="font-size:20px;margin-left:500px;">Search</h5>
</div>
<div class="row">
    <div class="col-md-2" style="min-height:690px">
        <table style="margin-left:10px">
            <tr>
                <td>
                    <div class="form-group">
                        <label class="lblSearch">Clinical case Id</label>
                        @Html.TextBoxFor(model => model.ClinicalCaseId, new { @class = "form-control", @autofocus = "autofocus", @id = "txtClinicalCaseId", @autocomplete = "off" })
                        @Html.ValidationMessageFor(model => model.ClinicalCaseId, null, new { @class = "text-danger" })
                        @Html.ValidationSummary(true, "", new { @class = "text-danger" })
                    </div>

                    <div class="form-group">
                        <label class="lblSearch">First Name</label>
                        @Html.TextBoxFor(model => model.FirstName, new { @class = "form-control", @autofocus = "autofocus", @id = "txtFirstName", @autocomplete = "off" })
                        @Html.ValidationMessageFor(model => model.FirstName, null, new { @class = "text-danger" })
                        @Html.ValidationSummary(true, "", new { @class = "text-danger" })
                    </div>

                    <div class="form-group">
                        <label class="lblSearch">Last Name</label>
                        @Html.TextBoxFor(model => model.LastName, new { @class = "form-control", @autofocus = "autofocus", @id = "txtLastName", @autocomplete = "off" })
                        @Html.ValidationMessageFor(model => model.LastName, null, new { @class = "text-danger" })
                        @Html.ValidationSummary(true, "", new { @class = "text-danger" })
                    </div>

                    <div class="form-group">
                        <label class="lblSearch">Provider Name </label>
                        @Html.TextBoxFor(model => model.ProviderName, new { @class = "form-control", @autofocus = "autofocus", @id = "txtProvidername", @autocomplete = "off" })
                        @Html.ValidationMessageFor(model => model.ProviderName, null, new { @class = "text-danger" })
                        @Html.ValidationSummary(true, "", new { @class = "text-danger" })
                    </div>
                    <div class="form-group">
                        <label class="lblSearch">MRN</label>
                        @Html.TextBoxFor(model => model.MRN, new { @class = "form-control", @autofocus = "autofocus", @id = "txtMRN", @autocomplete = "off" })
                        @Html.ValidationMessageFor(model => model.MRN, null, new { @class = "text-danger" })
                        @Html.ValidationSummary(true, "", new { @class = "text-danger" })
                    </div>

                    <div class="form-group">
                        <label class="lblSearch">DOS From</label>
                        @Html.TextBoxFor(model => model.DoSFrom, new { @class = "form-control", @type = "date", @autofocus = "autofocus", @id = "txtDoSFrom", @autocomplete = "off" })
                        @Html.ValidationMessageFor(model => model.DoSFrom, null, new { @class = "text-danger" })
                        @Html.ValidationSummary(true, "", new { @class = "text-danger" })
                    </div>

                    <div class="form-group">
                        <label class="lblSearch">DOS To</label>
                        @Html.TextBoxFor(model => model.DoSTo, new { @class = "form-control", @type = "date", @autofocus = "autofocus", @id = "txtDoSTo", @autocomplete = "off" })
                        @Html.ValidationMessageFor(model => model.DoSTo, null, new { @class = "text-danger" })
                        @Html.ValidationSummary(true, "", new { @class = "text-danger" })
                    </div>

                    <div class="form-group">
                        <label class="lblSearch">Status</label>
                        @Html.DropDownListFor(model => model.StatusName, new SelectList(@ViewBag.Status, "StatusId", "Name"), "--Select a Status--", new { @class = "form-control", @id = "statusdd" })
                        @Html.ValidationMessageFor(model => model.StatusName, null, new { @class = "text-danger" })
                        @Html.ValidationSummary(true, "", new { @class = "text-danger" })
                    </div>

                    <div class="form-group">
                        <label class="lblSearch">Project</label>
                        @Html.DropDownListFor(model => model.ProjectName, new SelectList(@ViewBag.Projects, "ProjectId", "Name"), "--Select a Project--", new { @class = "form-control", @id = "projectdd" })
                        @Html.ValidationMessageFor(model => model.ProjectName, null, new { @class = "text-danger" })
                        @Html.ValidationSummary(true, "", new { @class = "text-danger" })
                    </div>
                </td>
            </tr>
        </table>
        <br />
        <div style="margin-left:15px;">
            <button type="submit" class="btn btn-sm btn-info btn-fill" id="btnsubmit" onclick="Search()">Search</button>
            <button type="submit" class="btn btn-sm btn-danger btn-fill" id="btnclear" onclick="clearFields()">Clear</button>
        </div>
    </div>
    <div class="col-md-9">
        <div id="error" style="color:red;max-height:20px;"></div>
        <div id="modalContent"></div>
    </div>
</div>
<script src="~/dashboardassets/libs/jquery/dist/jquery.min.js"></script>
<script src="~/dashboardassets/libs/jquery-validation/dist/jquery.validate.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery-validation-unobtrusive/3.2.11/jquery.validate.unobtrusive.min.js" type="text/javascript"></script>
<script src="~/dashboardassets/extra-libs/DataTables/datatables.js"></script>

<script type="text/javascript">
    $(document).ready(function () {

            clearFields = function () {
            $("#txtClinicalCaseId").val('');
            $("#txtFirstName").val('');
            $("#txtLastName").val('');
            $("#txtMRN").val('');
            $("#txtDoSFrom").val('');
            $("#txtDoSTo").val('');
            $("#statusdd").find('option:selected').text("--Select a Status--");
            $("#projectdd").find('option:selected').text("--Select a Project--");
            $("#txtProvidername").val('');
                }

                Search = function () {

                    var ccid = $("#txtClinicalCaseId").val();
                    var fname = $("#txtFirstName").val();
                    var lname = $("#txtLastName").val();
                    var mrn = $("#txtMRN").val();
                    var dosfrom = $("#txtDoSFrom").val();
                    var dosto = $("#txtDoSTo").val();
                    var statusname = $("#statusdd").find('option:selected').text();
                    var projectname = $("#projectdd").find('option:selected').text();
                    var providername = $("#txtProvidername").val();
                    if (ccid !== "" || fname !=="" || lname !=="" || mrn !=="" || dosfrom !=="" || dosto !=="" || providername !=="" ||
                        projectname !== "--Select a Project--" || statusname !== "--Select a Status--") {
                $("#error").hide();
                $.ajax({
                        type: "POST",
                    url: "@Url.Action("SettingsSearch", "UAB")",
                    data: {
                        "ccid": $("#txtClinicalCaseId").val(),
                        "fname": $("#txtFirstName").val(),
                        "lname": $("#txtLastName").val(),
                        "mrn": $("#txtMRN").val(),
                        "dosfrom": $("#txtDoSFrom").val(),
                        "dosto": $("#txtDoSTo").val(),
                        "statusname": $("#statusdd").find('option:selected').text(),
                        "projectname": $("#projectdd").find('option:selected').text(),
                        "providername": $("#txtProvidername").val()
                    },
                    success: function (response) {
                        $("#modalContent").html(response);
                            },
                    failure: function (response) {
                                alert(response);
                            }
                        });
                    }
                    else {
                $("#error").html("Plese enter search parameters");
                $("#error").fadeOut(10000);
                    }
                }
            });
</script>
